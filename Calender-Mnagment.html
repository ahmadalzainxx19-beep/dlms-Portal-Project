<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة الفصول الدراسية - KAU</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Google Fonts (Cairo & Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="assets/styles.css">
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#005941',
                        accent: '#C89933',
                    },
                    fontFamily: {
                        sans: ['Cairo', 'sans-serif'],
                        english: ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
</head>
<body class="h-full flex overflow-hidden">
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar w-64 flex-col hidden lg:flex h-full fixed lg:relative z-30">
        <div class="h-20 flex items-center justify-center border-b border-white/10">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center text-primary font-bold border-2 border-accent">KAU</div>
                <h1 class="text-white font-bold text-lg" data-ar="بوابة الأنظمة" data-en="KAU Portal">بوابة الأنظمة</h1>
            </div>
    </div>
    
        <nav class="flex-1 overflow-y-auto py-6 px-3 space-y-1">
            <!-- Dashboard -->
            <a href="index.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group">
                <i data-feather="grid" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="لوحة التحكم" data-en="Dashboard">لوحة التحكم</span>
            </a>
            
            <!-- Buildings & Labs -->
            <div class="pt-4 pb-2 px-4 text-xs font-bold text-gray-400 uppercase tracking-wider" data-ar="إدارة المباني والمعامل" data-en="Buildings & Labs">إدارة المباني والمعامل</div>
            <a href="buildings.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group">
                <i data-feather="home" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="إدارة المباني" data-en="Buildings">إدارة المباني</span>
            </a>
            <a href="labs.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group">
                <i data-feather="monitor" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="إدارة المعامل" data-en="Labs">إدارة المعامل</span>
            </a>
            
            <!-- Exams -->
            <div class="pt-4 pb-2 px-4 text-xs font-bold text-gray-400 uppercase tracking-wider" data-ar="إدارة الاختبارات" data-en="Exams">إدارة الاختبارات</div>
            <a href="create-exam.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group" data-page="create-exam">
                <i data-feather="file-text" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="جدولة اختبار" data-en="Schedule Exam">جدولة اختبار</span>
            </a>
            
            <!-- Academic Calendar -->
            <div class="pt-4 pb-2 px-4 text-xs font-bold text-gray-400 uppercase tracking-wider" data-ar="التقويم الأكاديمي" data-en="Academic Calendar">التقويم الأكاديمي</div>
            <a href="Calender-Mnagment.html" class="sidebar-link active flex items-center px-4 py-3 rounded-lg group" data-page="Calender-Mnagment">
                <i data-feather="settings" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="إعدادات الفصول الدراسية" data-en="Term Configurations">إعدادات الفصول الدراسية</span>
            </a>
            <a href="AcadmicCalnder.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group" data-page="AcadmicCalnder">
                <i data-feather="calendar" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="عرض التقويم" data-en="View Calendar">عرض التقويم</span>
            </a>
            <a href="view-archive-calendar.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group" data-page="view-archive-calendar">
                <i data-feather="archive" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="الأرشيف" data-en="Archive">الأرشيف</span>
            </a>
            
            <!-- Users -->
            <div class="pt-4 pb-2 px-4 text-xs font-bold text-gray-400 uppercase tracking-wider" data-ar="إدارة المستخدمين" data-en="Users">إدارة المستخدمين</div>
            <a href="users.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group">
                <i data-feather="users" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="إدارة المستخدمين" data-en="User Management">إدارة المستخدمين</span>
            </a>
            
            <!-- Finance -->
            <div class="pt-4 pb-2 px-4 text-xs font-bold text-gray-400 uppercase tracking-wider" data-ar="الإدارة المالية" data-en="Finance">الإدارة المالية</div>
            <a href="finance-sittings.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group">
                <i data-feather="dollar-sign" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="الإعدادات المالية" data-en="Finance Settings">الإعدادات المالية</span>
            </a>
            <a href="contracts-management.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group">
                <i data-feather="file-text" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="إدارة العقود" data-en="Contracts">إدارة العقود</span>
            </a>
            
            <!-- Settings -->
            <div class="pt-4 pb-2 px-4 text-xs font-bold text-gray-400 uppercase tracking-wider" data-ar="الإعدادات" data-en="Settings">الإعدادات</div>
            <a href="setting.html" class="sidebar-link flex items-center px-4 py-3 rounded-lg group">
                <i data-feather="settings" class="w-5 h-5 ms-3"></i>
                <span class="font-medium" data-ar="الإعدادات العامة" data-en="General Settings">الإعدادات العامة</span>
            </a>
    </nav>

        <div class="p-4 border-t border-white/10">
            <a href="Login.html" class="w-full flex items-center justify-center gap-2 text-red-300 hover:text-red-100 transition-colors">
                <i data-feather="log-out" class="w-4 h-4"></i>
                <span class="text-sm font-bold" data-ar="تسجيل خروج" data-en="Logout">تسجيل خروج</span>
            </a>
    </div>
    </aside>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col min-w-0 overflow-hidden">
        <!-- Header -->
        <header class="sticky top-0 z-20 card-bg border-b border-custom shadow-sm">
            <div class="flex items-center justify-between px-6 py-4">
                <div class="flex items-center gap-4">
                    <button id="sidebarToggle" class="lg:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        <i data-feather="menu" class="w-5 h-5"></i>
                    </button>
                    <div>
                        <h2 class="text-xl font-bold" data-ar="إدارة الفصول الدراسية" data-en="Semester Management">إدارة الفصول الدراسية</h2>
                        <p class="text-sm text-muted" data-ar="إدارة الفصول الدراسية: بداية ونهاية الفصل، الإجازات، والإعدادات العامة" data-en="Manage semesters: start and end dates, holidays, and general settings">إدارة الفصول الدراسية: بداية ونهاية الفصل، الإجازات، والإعدادات العامة</p>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <button class="header-icon-hover p-2 rounded-lg transition-colors" id="themeToggle">
                        <i data-feather="moon" class="w-5 h-5"></i>
                    </button>
                    <button class="header-icon-hover p-2 rounded-lg transition-colors" id="langToggle">
                        <i data-feather="globe" class="w-5 h-5"></i>
                    </button>
                    <div class="flex items-center gap-2 ps-4 border-s border-custom">
                        <div class="text-end">
                            <div class="font-semibold" data-ar="د. وكيل العمادة" data-en="Dr. Vice Dean">د. وكيل العمادة</div>
                            <small class="text-muted text-xs" data-ar="مدير نظام" data-en="System Admin">مدير نظام</small>
                        </div>
                        <div class="w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center font-bold">VD</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto main-content-full-width">
            <div class="w-full p-6">
                <!-- الفصول الدراسية النشطة -->
                <div class="card-bg rounded-xl shadow-lg border border-custom border-t-4 border-t-green-600 mb-6">
                    <div class="p-6 border-b border-custom flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <i data-feather="calendar-check" class="w-5 h-5 text-green-600"></i>
                            <strong class="text-lg" data-ar="الفصول الدراسية النشطة" data-en="Active Semesters">الفصول الدراسية النشطة</strong>
                        </div>
                        <button class="btn-primary px-4 py-2 rounded-lg text-sm flex items-center gap-2" onclick="showAddSemesterModal()">
                            <i data-feather="plus" class="w-4 h-4"></i>
                            <span data-ar="إضافة فصل دراسي جديد" data-en="Add New Semester">إضافة فصل دراسي جديد</span>
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 dark:bg-gray-800 border-b border-custom">
                                <tr>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="اسم الفصل الدراسي" data-en="Semester Name">اسم الفصل الدراسي</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="تاريخ البدء" data-en="Start Date">تاريخ البدء</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="تاريخ النهاية" data-en="End Date">تاريخ النهاية</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="عدد الأسابيع" data-en="Weeks">عدد الأسابيع</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="الحالة" data-en="Status">الحالة</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="الإجراءات" data-en="Actions">الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="activeSemestersTable" class="divide-y divide-custom">
                                <tr class="card-bg hover:bg-primary/5 dark:hover:bg-primary/10 transition duration-150">
                                    <td class="px-6 py-4 font-bold">الفصل الدراسي الأول 1447هـ</td>
                                    <td class="px-6 py-4">20-08-2025</td>
                                    <td class="px-6 py-4">15-12-2025</td>
                                    <td class="px-6 py-4">15 أسبوع</td>
                                    <td class="px-6 py-4">
                                        <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 flex items-center gap-1 w-fit">
                                            <i data-feather="check-circle" class="w-3 h-3"></i>
                                            <span data-ar="نشط" data-en="Active">نشط</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="flex items-center gap-2">
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-blue-50 dark:bg-blue-900/30 text-blue-600 border border-blue-200 dark:border-blue-800" title="استعراض" onclick="viewSemester(1)">
                                                <i data-feather="eye" class="w-4 h-4"></i>
                                            </button>
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-yellow-50 dark:bg-yellow-900/30 text-yellow-600 border border-yellow-200 dark:border-yellow-800" title="تعديل" onclick="editSemester(1)">
                                                <i data-feather="edit" class="w-4 h-4"></i>
                                            </button>
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-red-50 dark:bg-red-900/30 text-red-600 border border-red-200 dark:border-red-800" title="إدارة الإجازات" onclick="manageHolidays(1)">
                                                <i data-feather="calendar" class="w-4 h-4"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="card-bg hover:bg-primary/5 dark:hover:bg-primary/10 transition duration-150">
                                    <td class="px-6 py-4 font-bold">الفصل الدراسي الثاني 1447هـ</td>
                                    <td class="px-6 py-4">15-01-2026</td>
                                    <td class="px-6 py-4">15-05-2026</td>
                                    <td class="px-6 py-4">15 أسبوع</td>
                                    <td class="px-6 py-4">
                                        <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 flex items-center gap-1 w-fit">
                                            <i data-feather="clock" class="w-3 h-3"></i>
                                            <span data-ar="قادم" data-en="Upcoming">قادم</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="flex items-center gap-2">
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-blue-50 dark:bg-blue-900/30 text-blue-600 border border-blue-200 dark:border-blue-800" title="استعراض" onclick="viewSemester(2)">
                                                <i data-feather="eye" class="w-4 h-4"></i>
                                            </button>
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-yellow-50 dark:bg-yellow-900/30 text-yellow-600 border border-yellow-200 dark:border-yellow-800" title="تعديل" onclick="editSemester(2)">
                                                <i data-feather="edit" class="w-4 h-4"></i>
                                            </button>
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-red-50 dark:bg-red-900/30 text-red-600 border border-red-200 dark:border-red-800" title="إدارة الإجازات" onclick="manageHolidays(2)">
                                                <i data-feather="calendar" class="w-4 h-4"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- الفصول الدراسية المنتهية -->
                <div class="card-bg rounded-xl shadow-lg border border-custom border-t-4 border-t-gray-500 mb-6">
                    <div class="p-6 border-b border-custom flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <i data-feather="archive" class="w-5 h-5 text-gray-500"></i>
                            <strong class="text-lg" data-ar="الفصول الدراسية المنتهية" data-en="Completed Semesters">الفصول الدراسية المنتهية</strong>
                        </div>
                        <div class="flex items-center gap-2">
                            <input type="text" class="px-3 py-1.5 text-sm border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent w-48" placeholder="بحث..." id="searchCompletedSemesters">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 dark:bg-gray-800 border-b border-custom">
                                <tr>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="اسم الفصل الدراسي" data-en="Semester Name">اسم الفصل الدراسي</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="تاريخ البدء" data-en="Start Date">تاريخ البدء</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="تاريخ النهاية" data-en="End Date">تاريخ النهاية</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="عدد الأسابيع" data-en="Weeks">عدد الأسابيع</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="الحالة" data-en="Status">الحالة</th>
                                    <th class="px-6 py-3 text-right font-semibold uppercase tracking-wider" data-ar="الإجراءات" data-en="Actions">الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="completedSemestersTable" class="divide-y divide-custom">
                                <tr class="card-bg hover:bg-primary/5 dark:hover:bg-primary/10 transition duration-150">
                                    <td class="px-6 py-4 font-bold">الفصل الدراسي الثاني 1446هـ</td>
                                    <td class="px-6 py-4">12-01-2025</td>
                                    <td class="px-6 py-4">15-05-2025</td>
                                    <td class="px-6 py-4">14 أسبوع</td>
                                    <td class="px-6 py-4">
                                        <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 flex items-center gap-1 w-fit">
                                            <i data-feather="archive" class="w-3 h-3"></i>
                                            <span data-ar="منتهي" data-en="Completed">منتهي</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="flex items-center gap-2">
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-blue-50 dark:bg-blue-900/30 text-blue-600 border border-blue-200 dark:border-blue-800" title="استعراض" onclick="viewSemester(3)">
                                                <i data-feather="eye" class="w-4 h-4"></i>
                                            </button>
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-green-50 dark:bg-green-900/30 text-green-600 border border-green-200 dark:border-green-800" title="استنساخ" onclick="cloneSemester(3)">
                                                <i data-feather="copy" class="w-4 h-4"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="card-bg hover:bg-primary/5 dark:hover:bg-primary/10 transition duration-150">
                                    <td class="px-6 py-4 font-bold">الفصل الصيفي 1446هـ</td>
                                    <td class="px-6 py-4">01-06-2025</td>
                                    <td class="px-6 py-4">15-08-2025</td>
                                    <td class="px-6 py-4">10 أسابيع</td>
                                    <td class="px-6 py-4">
                                        <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 flex items-center gap-1 w-fit">
                                            <i data-feather="archive" class="w-3 h-3"></i>
                                            <span data-ar="منتهي" data-en="Completed">منتهي</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="flex items-center gap-2">
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-blue-50 dark:bg-blue-900/30 text-blue-600 border border-blue-200 dark:border-blue-800" title="استعراض" onclick="viewSemester(4)">
                                                <i data-feather="eye" class="w-4 h-4"></i>
                                            </button>
                                            <button class="w-8 h-8 p-0 inline-flex items-center justify-center rounded-lg transition-all hover:translate-y-[-3px] hover:shadow-md bg-green-50 dark:bg-green-900/30 text-green-600 border border-green-200 dark:border-green-800" title="استنساخ" onclick="cloneSemester(4)">
                                                <i data-feather="copy" class="w-4 h-4"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card-bg rounded-xl border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 p-4 flex items-start gap-4 shadow-sm">
                    <i data-feather="info" class="w-6 h-6 text-primary flex-shrink-0 mt-0.5"></i>
                    <div>
                        <strong class="block mb-1" data-ar="ملاحظة مهمة:" data-en="Important Note:">ملاحظة مهمة:</strong> 
                        <span class="text-sm" data-ar="الفصول الدراسية المنتهية لا يمكن حذفها أو تعديلها لأنها مرتبطة بعمليات الحضور والغياب والمستحقات المالية التي تمت بالفعل. يمكنك استخدام ميزة الاستنساخ لإنشاء فصل دراسي جديد بناءً على فصل سابق." data-en="Completed semesters cannot be deleted or modified as they are linked to attendance, absence, and financial transactions that have already been processed. You can use the clone feature to create a new semester based on a previous one.">
                            الفصول الدراسية المنتهية لا يمكن حذفها أو تعديلها لأنها مرتبطة بعمليات الحضور والغياب والمستحقات المالية التي تمت بالفعل. يمكنك استخدام ميزة الاستنساخ لإنشاء فصل دراسي جديد بناءً على فصل سابق.
                        </span>
                    </div>
                </div>
            </div>

        </main>

        <!-- Footer -->
        <footer class="p-4 border-t border-custom text-center text-muted text-sm card-bg flex-shrink-0">
            <div id="liveDateTime" class="font-bold text-primary mb-1 font-english" style="direction: ltr;"></div>
            <div data-ar="جميع الحقوق محفوظة © 2026 م. أحمد فلمبان | رقم الإصدار: 2.0" data-en="All rights reserved © 2026 Eng. Ahmed Filban | Version: 2.0">جميع الحقوق محفوظة © 2026 م. أحمد فلمبان | رقم الإصدار: 2.0</div>
        </footer>
    </div>
</div>
</div>


<script>
    // إظهار Modal إضافة فصل دراسي
    function showAddSemesterModal() {
        Swal.fire({
            title: '<span data-ar="إضافة فصل دراسي جديد" data-en="Add New Semester">إضافة فصل دراسي جديد</span>',
            html: `
                <form id="semesterForm" class="text-right">
                    <input type="hidden" id="semesterId">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2" data-ar="اسم الفصل الدراسي" data-en="Semester Name">اسم الفصل الدراسي <span class="text-red-600">*</span></label>
                            <input type="text" class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="semesterName" required placeholder="مثال: الفصل الدراسي الأول 1447هـ">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2" data-ar="نوع الفصل" data-en="Semester Type">نوع الفصل <span class="text-red-600">*</span></label>
                            <select class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="semesterType" required>
                                <option value="">اختر النوع...</option>
                                <option value="1" data-ar="الفصل الدراسي الأول" data-en="First Semester">الفصل الدراسي الأول</option>
                                <option value="2" data-ar="الفصل الدراسي الثاني" data-en="Second Semester">الفصل الدراسي الثاني</option>
                                <option value="S" data-ar="الفصل الصيفي" data-en="Summer Semester">الفصل الصيفي</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2" data-ar="تاريخ البدء" data-en="Start Date">تاريخ البدء <span class="text-red-600">*</span></label>
                            <input type="date" class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="startDate" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2" data-ar="تاريخ النهاية" data-en="End Date">تاريخ النهاية <span class="text-red-600">*</span></label>
                            <input type="date" class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="endDate" required>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2" data-ar="الوصف (اختياري)" data-en="Description (Optional)">الوصف (اختياري)</label>
                        <textarea class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="semesterDescription" rows="3" placeholder="ملاحظات إضافية عن الفصل الدراسي..."></textarea>
                    </div>
                </form>
            `,
            showCancelButton: true,
            confirmButtonText: '<span data-ar="حفظ" data-en="Save">حفظ</span>',
            cancelButtonText: '<span data-ar="إلغاء" data-en="Cancel">إلغاء</span>',
            confirmButtonColor: '#005941',
            cancelButtonColor: '#6b7280',
            width: '600px',
            didOpen: () => {
                document.getElementById('semesterForm').reset();
                document.getElementById('semesterId').value = '';
                feather.replace();
            },
            preConfirm: () => {
                const form = document.getElementById('semesterForm');
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return false;
                }
                return {
                    id: document.getElementById('semesterId').value,
                    name: document.getElementById('semesterName').value,
                    type: document.getElementById('semesterType').value,
                    startDate: document.getElementById('startDate').value,
                    endDate: document.getElementById('endDate').value,
                    description: document.getElementById('semesterDescription').value
                };
            }
        }).then((result) => {
            if (result.isConfirmed && result.value) {
                // TODO: إرسال البيانات إلى API
                console.log('Saving semester:', result.value);
                Swal.fire({
                    icon: 'success',
                    title: '<span data-ar="تم الحفظ" data-en="Saved">تم الحفظ</span>',
                    text: '<span data-ar="تم حفظ الفصل الدراسي بنجاح" data-en="Semester saved successfully">تم حفظ الفصل الدراسي بنجاح</span>',
                    confirmButtonColor: '#005941'
                });
                // location.reload();
            }
        });
    }

    // تعديل فصل دراسي
    function editSemester(id) {
        // TODO: جلب بيانات الفصل الدراسي من API
        Swal.fire({
            title: '<span data-ar="تعديل فصل دراسي" data-en="Edit Semester">تعديل فصل دراسي</span>',
            html: `
                <form id="semesterForm" class="text-right">
                    <input type="hidden" id="semesterId" value="${id}">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2" data-ar="اسم الفصل الدراسي" data-en="Semester Name">اسم الفصل الدراسي <span class="text-red-600">*</span></label>
                            <input type="text" class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="semesterName" required placeholder="مثال: الفصل الدراسي الأول 1447هـ">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2" data-ar="نوع الفصل" data-en="Semester Type">نوع الفصل <span class="text-red-600">*</span></label>
                            <select class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="semesterType" required>
                                <option value="">اختر النوع...</option>
                                <option value="1" data-ar="الفصل الدراسي الأول" data-en="First Semester">الفصل الدراسي الأول</option>
                                <option value="2" data-ar="الفصل الدراسي الثاني" data-en="Second Semester">الفصل الدراسي الثاني</option>
                                <option value="S" data-ar="الفصل الصيفي" data-en="Summer Semester">الفصل الصيفي</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2" data-ar="تاريخ البدء" data-en="Start Date">تاريخ البدء <span class="text-red-600">*</span></label>
                            <input type="date" class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="startDate" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2" data-ar="تاريخ النهاية" data-en="End Date">تاريخ النهاية <span class="text-red-600">*</span></label>
                            <input type="date" class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="endDate" required>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2" data-ar="الوصف (اختياري)" data-en="Description (Optional)">الوصف (اختياري)</label>
                        <textarea class="w-full px-4 py-2 border border-custom rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" id="semesterDescription" rows="3" placeholder="ملاحظات إضافية عن الفصل الدراسي..."></textarea>
                    </div>
                </form>
            `,
            showCancelButton: true,
            confirmButtonText: '<span data-ar="حفظ" data-en="Save">حفظ</span>',
            cancelButtonText: '<span data-ar="إلغاء" data-en="Cancel">إلغاء</span>',
            confirmButtonColor: '#005941',
            cancelButtonColor: '#6b7280',
            width: '600px',
            didOpen: () => {
                // TODO: تعبئة النموذج بالبيانات
                feather.replace();
            },
            preConfirm: () => {
                const form = document.getElementById('semesterForm');
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return false;
                }
                return {
                    id: document.getElementById('semesterId').value,
                    name: document.getElementById('semesterName').value,
                    type: document.getElementById('semesterType').value,
                    startDate: document.getElementById('startDate').value,
                    endDate: document.getElementById('endDate').value,
                    description: document.getElementById('semesterDescription').value
                };
            }
        }).then((result) => {
            if (result.isConfirmed && result.value) {
                // TODO: إرسال البيانات إلى API
                console.log('Updating semester:', result.value);
                Swal.fire({
                    icon: 'success',
                    title: '<span data-ar="تم التحديث" data-en="Updated">تم التحديث</span>',
                    text: '<span data-ar="تم تحديث الفصل الدراسي بنجاح" data-en="Semester updated successfully">تم تحديث الفصل الدراسي بنجاح</span>',
                    confirmButtonColor: '#005941'
                });
                // location.reload();
            }
        });
    }

    // استعراض فصل دراسي
    function viewSemester(id) {
        // TODO: عرض تفاصيل الفصل الدراسي
        Swal.fire({
            icon: 'info',
            title: '<span data-ar="تفاصيل الفصل الدراسي" data-en="Semester Details">تفاصيل الفصل الدراسي</span>',
            text: '<span data-ar="عرض تفاصيل الفصل الدراسي رقم: " data-en="Viewing semester details #">عرض تفاصيل الفصل الدراسي رقم: </span>' + id,
            confirmButtonColor: '#005941'
        });
    }

    // إدارة الإجازات
    function manageHolidays(id) {
        // TODO: فتح صفحة إدارة الإجازات للفصل الدراسي
        Swal.fire({
            icon: 'info',
            title: '<span data-ar="إدارة الإجازات" data-en="Manage Holidays">إدارة الإجازات</span>',
            text: '<span data-ar="إدارة الإجازات للفصل الدراسي رقم: " data-en="Managing holidays for semester #">إدارة الإجازات للفصل الدراسي رقم: </span>' + id,
            confirmButtonColor: '#005941'
        });
    }

    // حفظ فصل دراسي
    function saveSemester() {
        // This function is now handled by SweetAlert2 in showAddSemesterModal
    }

    // استنساخ فصل دراسي
    function cloneSemester(id) {
        Swal.fire({
            icon: 'question',
            title: '<span data-ar="استنساخ الفصل الدراسي" data-en="Clone Semester">استنساخ الفصل الدراسي</span>',
            text: '<span data-ar="هل تريد استنساخ هذا الفصل الدراسي لإنشاء فصل جديد؟" data-en="Do you want to clone this semester to create a new one?">هل تريد استنساخ هذا الفصل الدراسي لإنشاء فصل جديد؟</span>',
            showCancelButton: true,
            confirmButtonText: '<span data-ar="نعم، استنساخ" data-en="Yes, Clone">نعم، استنساخ</span>',
            cancelButtonText: '<span data-ar="إلغاء" data-en="Cancel">إلغاء</span>',
            confirmButtonColor: '#005941',
            cancelButtonColor: '#6b7280'
        }).then((result) => {
            if (result.isConfirmed) {
                // TODO: استنساخ الفصل الدراسي
                Swal.fire({
                    icon: 'success',
                    title: '<span data-ar="تم الاستنساخ" data-en="Cloned">تم الاستنساخ</span>',
                    text: '<span data-ar="تم استنساخ الفصل الدراسي بنجاح" data-en="Semester cloned successfully">تم استنساخ الفصل الدراسي بنجاح</span>',
                    confirmButtonColor: '#005941'
                });
                showAddSemesterModal();
            }
        });
    }

    function updateTime() {
        const now = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
        document.getElementById('liveDateTime').innerText = now.toLocaleDateString('ar-SA', options);
    }
    setInterval(updateTime, 1000); updateTime();
    
    // Initialize Feather Icons
    feather.replace();
    
    // Theme Toggle
    const themeToggle = document.getElementById('themeToggle');
    const html = document.documentElement;
    const themeIcon = themeToggle?.querySelector('i');
    
    // Check for saved theme preference
    const currentTheme = localStorage.getItem('theme') || 'light';
    if (currentTheme === 'dark') {
        html.classList.add('dark');
        if (themeIcon) themeIcon.setAttribute('data-feather', 'sun');
    }
    
    themeToggle?.addEventListener('click', () => {
        html.classList.toggle('dark');
        const isDark = html.classList.contains('dark');
        if (themeIcon) themeIcon.setAttribute('data-feather', isDark ? 'sun' : 'moon');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        feather.replace();
    });
    
    // Language Toggle
    let isArabic = true;
    const langToggle = document.getElementById('langToggle');
    langToggle?.addEventListener('click', () => {
        isArabic = !isArabic;
        document.documentElement.lang = isArabic ? 'ar' : 'en';
        document.documentElement.dir = isArabic ? 'rtl' : 'ltr';
        
        // Update all text elements
        document.querySelectorAll('[data-ar][data-en]').forEach(el => {
            el.textContent = isArabic ? el.getAttribute('data-ar') : el.getAttribute('data-en');
        });
        feather.replace();
    });
    
    // Set active page in sidebar
    (function() {
        const currentPage = window.location.pathname.split('/').pop().replace('.html', '');
        const activeLink = document.querySelector(`[data-page="${currentPage}"]`);
        if (activeLink) {
            activeLink.classList.add('active');
        }
        
        // Sidebar Toggle for Mobile
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        if (sidebarToggle && sidebar) {
            sidebarToggle.addEventListener('click', () => {
                sidebar.classList.toggle('hidden');
            });
        }
    })();
</script>
</body>
</html>